# ğŸ—ï¸ æ•æ„Ÿè¯æ£€æµ‹æ¡†æ¶ - æŠ€æœ¯æ¶æ„æµç¨‹å›¾

## ğŸ“‹ ç³»ç»Ÿæ¦‚è§ˆ

**æ•æ„Ÿè¯æ£€æµ‹æ¡†æ¶**æ˜¯ä¸€ä¸ªä¼ä¸šçº§ã€é«˜æ€§èƒ½çš„å†…å®¹å®‰å…¨æ£€æµ‹ç³»ç»Ÿï¼Œé‡‡ç”¨**æœ¬åœ°+äº‘ç«¯æ··åˆæ£€æµ‹**ç­–ç•¥ï¼Œä¸ºå¼€å‘è€…æä¾›å®Œæ•´çš„æ•æ„Ÿå†…å®¹è¯†åˆ«è§£å†³æ–¹æ¡ˆã€‚

## ğŸ”„ æŠ€æœ¯æµç¨‹å›¾

```mermaid
graph TD
    %% ç”¨æˆ·è¾“å…¥å±‚
    A["ğŸ‘¤ ç”¨æˆ·è¾“å…¥æ–‡æœ¬"] --> B{"ğŸ“ æ–‡æœ¬é¢„å¤„ç†"}
    B --> |"éªŒè¯é•¿åº¦/æ ¼å¼"| C["ğŸ” æ£€æµ‹å¼•æ“å¯åŠ¨"]

    %% æ£€æµ‹å¼•æ“å±‚
    C --> D["ğŸ  æœ¬åœ°æ£€æµ‹å¼•æ“"]
    C --> E["â˜ï¸ Azure AI æ£€æµ‹å¼•æ“"]

    %% æœ¬åœ°æ£€æµ‹è¯¦æƒ…
    D --> D1["ğŸ“š æ•æ„Ÿè¯åº“åŠ è½½<br/>86,992 è¯æ±‡"]
    D1 --> D2["âš¡ AhoCorasick ç®—æ³•<br/>O(n) æ—¶é—´å¤æ‚åº¦"]
    D2 --> D3["ğŸ›¡ï¸ æ™ºèƒ½ç™½åå•è¿‡æ»¤<br/>é¿å…è¯¯åˆ¤"]
    D3 --> D4["ğŸ“Š é£é™©è¯„åˆ†è®¡ç®—<br/>5å¤§ç±»æ•æ„Ÿå†…å®¹"]

    %% Azureæ£€æµ‹è¯¦æƒ…
    E --> E1["ğŸ¤– Azure Content Safety API"]
    E1 --> E2["ğŸŒ å¤šè¯­è¨€ AI åˆ†æ<br/>4ä¸ªå®‰å…¨ç»´åº¦"]
    E2 --> E3["ğŸ“ˆ ä¸¥é‡åº¦è¯„ä¼°<br/>0-6 çº§åˆ«"]

    %% å†³ç­–å¼•æ“
    D4 --> F["ğŸ§  æ··åˆå†³ç­–å¼•æ“"]
    E3 --> F
    F --> |"ä¸¥æ ¼ OR é€»è¾‘"| G{"âš–ï¸ ç»¼åˆåˆ¤æ–­"}

    %% ç»“æœåˆ†çº§
    G --> |"åˆ†æ•° 0-0.9"| H1["âœ… SAFE<br/>æ— æ•æ„Ÿå†…å®¹"]
    G --> |"åˆ†æ•° 1-7.9"| H2["âš ï¸ WARNING<br/>å¯ç–‘å†…å®¹"]
    G --> |"åˆ†æ•° 8+"| H3["ğŸš« FORBIDDEN<br/>è¿ç¦å†…å®¹"]

    %% å“åº”æ¨¡å¼
    H1 --> I{"ğŸ”§ å“åº”æ¨¡å¼é€‰æ‹©"}
    H2 --> I
    H3 --> I

    I --> |"debug: false"| J["ğŸ“¦ æç®€å“åº”<br/>level, score, confidence"]
    I --> |"debug: true"| K["ğŸ“‹ è¯¦ç»†å“åº”<br/>å®Œæ•´åˆ†ææŠ¥å‘Š"]

    %% è¾“å‡ºæ¥å£
    J --> L["ğŸŒ REST API"]
    K --> L
    L --> M["ğŸ“± å¤šç«¯SDKæ”¯æŒ"]

    %% SDKæ”¯æŒ
    M --> M1["ğŸ’» Node.js SDK"]
    M --> M2["ğŸŒ Browser SDK"]
    M --> M3["ğŸ Python SDK<br/>è®¡åˆ’ä¸­"]

    %% éƒ¨ç½²æ–¹å¼
    L --> N["ğŸš€ éƒ¨ç½²é€‰é¡¹"]
    N --> N1["ğŸ³ Docker å®¹å™¨"]
    N --> N2["â˜ï¸ äº‘æœåŠ¡å™¨"]
    N --> N3["ğŸ¢ æœ¬åœ°éƒ¨ç½²"]

    %% æ ·å¼å®šä¹‰
    classDef inputClass fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef engineClass fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef localClass fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef azureClass fill:#e3f2fd,stroke:#0d47a1,stroke-width:2px
    classDef decisionClass fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef resultClass fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    classDef apiClass fill:#f1f8e9,stroke:#33691e,stroke-width:2px
    classDef deployClass fill:#f9fbe7,stroke:#827717,stroke-width:2px

    class A,B inputClass
    class C engineClass
    class D,D1,D2,D3,D4 localClass
    class E,E1,E2,E3 azureClass
    class F,G decisionClass
    class H1,H2,H3,I,J,K resultClass
    class L,M,M1,M2,M3 apiClass
    class N,N1,N2,N3 deployClass
```

## ğŸ¯ æ ¸å¿ƒæŠ€æœ¯æ¨¡å—

### 1. **è¾“å…¥å¤„ç†å±‚**
- **æ–‡æœ¬é¢„å¤„ç†**: æ ¼å¼éªŒè¯ã€é•¿åº¦æ£€æŸ¥ï¼ˆæœ€å¤§10,000å­—ç¬¦ï¼‰
- **ç¼–ç æ ‡å‡†åŒ–**: UTF-8ç»Ÿä¸€å¤„ç†
- **è¾“å…¥æ¸…ç†**: ç‰¹æ®Šå­—ç¬¦å¤„ç†

### 2. **åŒå¼•æ“æ£€æµ‹å±‚**

#### ğŸ  æœ¬åœ°æ£€æµ‹å¼•æ“
```
ğŸ“š æ•æ„Ÿè¯åº“
â”œâ”€â”€ 86,992 æ€»è¯æ±‡é‡
â”œâ”€â”€ 51,308 å»é‡è¯æ±‡
â”œâ”€â”€ 16ä¸ªåˆ†ç±»è¯åº“æ–‡ä»¶
â””â”€â”€ 5å¤§æ•æ„Ÿå†…å®¹ç±»åˆ«
```

**æ£€æµ‹ç®—æ³•**:
- **AhoCorasick è‡ªåŠ¨æœº**: O(n) æ—¶é—´å¤æ‚åº¦
- **æ™ºèƒ½ç™½åå•**: 35+å¸¸ç”¨è¯æ±‡é¿å…è¯¯åˆ¤
- **é£é™©è¯„åˆ†**: åŸºäºè¯æ±‡ç±»å‹å’Œé¢‘æ¬¡

#### â˜ï¸ Azure AI æ£€æµ‹å¼•æ“
```
ğŸ¤– Azure Content Safety
â”œâ”€â”€ å¤šè¯­è¨€AIè¯­ä¹‰åˆ†æ
â”œâ”€â”€ 4ä¸ªå®‰å…¨ç»´åº¦æ£€æµ‹
â”‚   â”œâ”€â”€ Hate (ä»‡æ¨è¨€è®º)
â”‚   â”œâ”€â”€ Violence (æš´åŠ›å†…å®¹)
â”‚   â”œâ”€â”€ Sexual (æ€§ç›¸å…³)
â”‚   â””â”€â”€ SelfHarm (è‡ªä¼¤)
â””â”€â”€ 0-6çº§ä¸¥é‡åº¦è¯„ä¼°
```

### 3. **æ··åˆå†³ç­–å¼•æ“**

#### ğŸ  æœ¬åœ°æ£€æµ‹åˆ¤æ–­é€»è¾‘

**ğŸš« Forbidden (ä¸¥é‡è¿ç¦) æ¡ä»¶** - ä»»ä¸€æ¡ä»¶æ»¡è¶³å³ä¸º forbiddenï¼š

1. **ç›´æ¥ç²—ä¿—è¾±éª‚** (`analysis.curseWords = true`)
   - å¦‚ï¼šæ“ä½ å¦ˆã€å‚»é€¼ã€æ»šä½ å¦ˆçš„è›‹ç­‰
   - é£é™©åˆ†æ•°ï¼š+10åˆ†

2. **æ”¿æ²»æ•æ„Ÿå†…å®¹** (`analysis.politicalSensitive = true`)
   - å¦‚ï¼šä¹ è¿‘å¹³æ˜¯ç‹¬è£ã€æ¨ç¿»å…±äº§å…šã€ä¸€å…šä¸“åˆ¶ç­‰
   - é£é™©åˆ†æ•°ï¼š+8åˆ†

3. **æš´åŠ›å¨èƒ** (`analysis.violenceThreat = true`)
   - å¦‚ï¼šæˆ‘è¦æ€äº†ä½ ã€ç‚¸æ‰è¿™ä¸ªåœ°æ–¹ã€è¡€æ´—ç­‰
   - é£é™©åˆ†æ•°ï¼š+9åˆ†

4. **ç´¯ç§¯é£é™©åˆ†æ•° â‰¥ 8**
   - åŒ…æ‹¬ç§æ—æ­§è§† (+8åˆ†)ã€æç«¯è¨€è®º (+9åˆ†)
   - æ”¿æ²»/æš´æè¯åº“åŒ¹é… (+3åˆ†/è¯)

**âš ï¸ Warning (å¯ç–‘å†…å®¹) æ¡ä»¶** - å½“ä¸æ»¡è¶³ forbidden æ¡ä»¶æ—¶ï¼š

1. **é£é™©åˆ†æ•° â‰¥ 2**
   - ç†ç”±ï¼š`å¯ç–‘å†…å®¹ (é£é™©åˆ†æ•°: X, åŒ¹é…è¯æ±‡: X)`
   - ç½®ä¿¡åº¦ï¼š0.75

2. **é£é™©åˆ†æ•° â‰¥ 1**
   - ç†ç”±ï¼š`è½»åº¦æ•æ„Ÿå†…å®¹`
   - ç½®ä¿¡åº¦ï¼š0.65

**âœ… Safe (å®‰å…¨å†…å®¹)**
- **é£é™©åˆ†æ•° < 1**
- ç†ç”±ï¼š`æ— æ•æ„Ÿå†…å®¹`
- ç½®ä¿¡åº¦ï¼š0.95

#### ğŸ“Š é£é™©åˆ†æ•°ç´¯ç§¯è§„åˆ™

```typescript
// é«˜é£é™©ç±»åˆ«
ç›´æ¥ç²—ä¿—è¾±éª‚: +10åˆ†
æš´åŠ›å¨èƒ: +9åˆ†
æç«¯è¨€è®º: +9åˆ†
æ”¿æ²»æ•æ„Ÿ: +8åˆ†
ç§æ—æ­§è§†: +8åˆ†

// è¯åº“åŒ¹é…
æ”¿æ²»ç±»å‹/ååŠ¨è¯åº“: +3åˆ†/è¯
æš´æè¯åº“/æ¶‰æªæ¶‰çˆ†: +3åˆ†/è¯
å…¶ä»–æ•æ„Ÿè¯: +1åˆ†/è¯ (å•å­—ç¬¦é™æƒè‡³0.2åˆ†)

// è­¦å‘Šçº§åˆ«
è­¦å‘Šå…³é”®è¯: +0.5åˆ†/è¯
```

#### âš–ï¸ æ··åˆå†³ç­–é€»è¾‘

```
âš–ï¸ å†³ç­–é€»è¾‘: ä¸¥æ ¼ OR ç­–ç•¥
â”œâ”€â”€ æœ¬åœ°æ£€æµ‹ = å±é™© â†’ ç»“æœ = å±é™©
â”œâ”€â”€ Azureæ£€æµ‹ = å±é™© â†’ ç»“æœ = å±é™©
â”œâ”€â”€ åŒæ–¹éƒ½å®‰å…¨ â†’ ç»“æœ = å®‰å…¨
â””â”€â”€ æœ€å¤§åŒ–æ£€æµ‹è¦†ç›–ç‡ï¼Œæœ€å°åŒ–æ¼æ£€
```

**æ ¸å¿ƒåŸåˆ™ï¼šä¸¥é‡ç±»åˆ«ç›´æ¥è§¦å‘ forbiddenï¼Œç´¯ç§¯åˆ†æ•°å†³å®šæœ€ç»ˆçº§åˆ«**

### 4. **ç»“æœåˆ†çº§ç³»ç»Ÿ**
| çº§åˆ«            | åˆ†æ•°èŒƒå›´  | æè¿°       | å»ºè®®å¤„ç† |
| --------------- | --------- | ---------- | -------- |
| ğŸŸ¢ **SAFE**      | 0 - 0.9   | æ— æ•æ„Ÿå†…å®¹ | ç›´æ¥é€šè¿‡ |
| ğŸŸ¡ **WARNING**   | 1.0 - 7.9 | å¯ç–‘å†…å®¹   | äººå·¥å®¡æ ¸ |
| ğŸ”´ **FORBIDDEN** | 8.0+      | è¿ç¦å†…å®¹   | ç›´æ¥æ‹¦æˆª |

### 5. **åŒå“åº”æ¨¡å¼**

#### ğŸ“¦ æç®€æ¨¡å¼ (é»˜è®¤)
```json
{
  "success": true,
  "level": "safe",
  "score": 0,
  "confidence": 0.95,
  "meta": {
    "timestamp": "2025-01-01T12:00:00Z",
    "processingTime": 2,
    "version": "1.0.0"
  }
}
```

#### ğŸ“‹ è¯¦ç»†æ¨¡å¼ (debug: true)
```json
{
  "success": true,
  "result": {
    "level": "safe",
    "reason": "è¯¦ç»†æ£€æµ‹è¯´æ˜",
    "confidence": 0.95,
    "details": {
      "local": { /* æœ¬åœ°æ£€æµ‹è¯¦æƒ… */ },
      "azure": { /* Azureæ£€æµ‹è¯¦æƒ… */ },
      "finalDecision": { /* å†³ç­–é€»è¾‘ */ }
    }
  },
  "meta": { /* å…ƒæ•°æ® */ }
}
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡         | æœ¬åœ°æ£€æµ‹  | Azureæ£€æµ‹ | æ··åˆæ£€æµ‹    |
| ------------ | --------- | --------- | ----------- |
| **å“åº”æ—¶é—´** | 1-3ms     | 50-200ms  | 50-300ms    |
| **å¹¶å‘å¤„ç†** | 1000+ QPS | 100+ QPS  | 100+ QPS    |
| **å‡†ç¡®ç‡**   | 95%+      | 98%+      | 99%+        |
| **è¯­è¨€æ”¯æŒ** | ä¸­æ–‡      | å¤šè¯­è¨€    | ä¸­æ–‡+å¤šè¯­è¨€ |

## ğŸš€ æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæŠ€æœ¯
- **Runtime**: Bun (é«˜æ€§èƒ½JavaScriptè¿è¡Œæ—¶)
- **è¯­è¨€**: TypeScript (ç±»å‹å®‰å…¨)
- **ç®—æ³•**: AhoCorasickè‡ªåŠ¨æœº
- **AIæœåŠ¡**: Azure Content Safety

### API & SDK
- **APIæ¡†æ¶**: Bun.serve (åŸç”ŸHTTPæœåŠ¡)
- **SDKè¯­è¨€**: TypeScript (Node.js + Browser)
- **æœªæ¥æ”¯æŒ**: Python SDK

### éƒ¨ç½² & DevOps
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **é…ç½®ç®¡ç†**: ç¯å¢ƒå˜é‡ + .envæ–‡ä»¶
- **ç›‘æ§**: å¥åº·æ£€æŸ¥ + ç»Ÿè®¡æ¥å£

## ğŸ¯ åº”ç”¨åœºæ™¯

### 1. **å†…å®¹å®¡æ ¸å¹³å°**
```typescript
// å®æ—¶å†…å®¹è¿‡æ»¤
const result = await client.detect(userContent);
if (result.level === 'forbidden') {
  return 'å†…å®¹è¿è§„ï¼Œè¯·ä¿®æ”¹åé‡è¯•';
}
```

### 2. **ç¤¾äº¤åª’ä½“åº”ç”¨**
```typescript
// æ‰¹é‡æ¶ˆæ¯æ£€æµ‹
const messages = ['æ¶ˆæ¯1', 'æ¶ˆæ¯2', 'æ¶ˆæ¯3'];
const results = await client.detectBatch(messages);
```

### 3. **è®ºå›ç³»ç»Ÿ**
```typescript
// å¸–å­è¯„è®ºå®¡æ ¸
const post = await client.detect(postContent, true); // è¯¦ç»†æ¨¡å¼
if (post.result.level !== 'safe') {
  logAuditResult(post.result.details);
}
```

### 4. **ä¼ä¸šæ–‡æ¡£æ‰«æ**
```typescript
// æ–‡æ¡£å®‰å…¨æ‰«æ
const documents = await scanDocuments();
const risks = documents.filter(doc =>
  doc.result.level === 'forbidden'
);
```

## ğŸ”§ å¿«é€Ÿå¼€å§‹

### 1. **éƒ¨ç½²APIæœåŠ¡**
```bash
# Dockeræ–¹å¼
docker run -p 3000:3000 \
  -e AZURE_CONTENT_MODERATOR_ENDPOINT="your-endpoint" \
  -e AZURE_CONTENT_MODERATOR_KEY="your-key" \
  sensitive-word-api

# æˆ–è€…ç›´æ¥è¿è¡Œ
bun install
bun run dev
```

### 2. **ä½¿ç”¨SDK**
```typescript
import { SensitiveWordClient } from 'sensitive-word-sdk';

const client = new SensitiveWordClient({
  baseURL: 'http://localhost:3000'
});

// ç®€å•æ£€æµ‹
const result = await client.detect('æµ‹è¯•æ–‡æœ¬');
console.log(result.level); // 'safe' | 'warning' | 'forbidden'

// è¯¦ç»†æ£€æµ‹
const detailed = await client.detect('æµ‹è¯•æ–‡æœ¬', true);
console.log(detailed.result.details);
```

### 3. **REST APIè°ƒç”¨**
```bash
# æç®€æ¨¡å¼
curl -X POST http://localhost:3000/api/detect \
  -H "Content-Type: application/json" \
  -d '{"text":"æµ‹è¯•å†…å®¹"}'

# è¯¦ç»†æ¨¡å¼
curl -X POST http://localhost:3000/api/detect \
  -H "Content-Type: application/json" \
  -d '{"text":"æµ‹è¯•å†…å®¹","debug":true}'
```

## ğŸ“ˆ å‘å±•è·¯çº¿å›¾

### âœ… å·²å®Œæˆ
- [x] åŒå¼•æ“æ··åˆæ£€æµ‹æ¶æ„
- [x] TypeScript SDK (Node.js + Browser)
- [x] REST API ä¸åŒå“åº”æ¨¡å¼
- [x] Docker å®¹å™¨åŒ–éƒ¨ç½²
- [x] å®Œæ•´æ–‡æ¡£å’Œç¤ºä¾‹

### ğŸš§ å¼€å‘ä¸­
- [ ] Python SDK
- [ ] æ€§èƒ½ç›‘æ§é¢æ¿
- [ ] è‡ªå®šä¹‰è¯åº“ç®¡ç†
- [ ] æ‰¹é‡æ–‡ä»¶æ£€æµ‹

### ğŸ¯ æœªæ¥è®¡åˆ’
- [ ] Go/Java SDK
- [ ] æœºå™¨å­¦ä¹ æ¨¡å‹é›†æˆ
- [ ] å›¾ç‰‡/è§†é¢‘å†…å®¹æ£€æµ‹
- [ ] ä¼ä¸šçº§ç®¡ç†åå°

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **æ–‡æ¡£**: [APIæ–‡æ¡£](./API.md)
- **ç¤ºä¾‹**: [SDKä½¿ç”¨ç¤ºä¾‹](../examples/)
- **æºç **: [GitHubä»“åº“](https://github.com/your-repo/sensitive-word-check)
- **é—®é¢˜åé¦ˆ**: [Issues](https://github.com/your-repo/sensitive-word-check/issues)

---

**Â© 2025 æ•æ„Ÿè¯æ£€æµ‹æ¡†æ¶ - ä¼ä¸šçº§å†…å®¹å®‰å…¨è§£å†³æ–¹æ¡ˆ**